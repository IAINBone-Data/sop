<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SOP IAIN Bone</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    body { font-family: 'Inter', sans-serif; display: flex; flex-direction: column; min-height: 100vh; }
    #main-app { flex-grow: 1; }
    html, body {
        scroll-behavior: smooth;
    }
  </style>
</head>
<body class="bg-slate-50">

  <!-- Custom Alert Modal -->
  <div id="custom-alert-modal" class="modal-overlay fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-50 hidden">
    <div class="w-full max-w-sm p-6 space-y-4 bg-white rounded-xl shadow-lg text-center transform transition-all">
        <div id="custom-alert-icon-container" class="mx-auto flex items-center justify-center h-12 w-12 rounded-full">
            <!-- Icon will be injected here -->
        </div>
        <p id="custom-alert-message" class="text-lg font-medium text-gray-700"></p>
        <button id="close-custom-alert" class="w-full px-4 py-2 font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700">Tutup</button>
    </div>
</div>

  <!-- Modal Login -->
  <div id="login-modal" class="modal-overlay fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 hidden">
    <div class="w-full max-w-md p-8 space-y-6 bg-white rounded-xl shadow-lg transform transition-all" id="login-modal-content">
      <div class="text-center">
        <h1 class="text-2xl font-bold text-gray-800">Login Administrator</h1>
        <p class="text-gray-500">Silakan login untuk melanjutkan</p>
      </div>
      <form id="login-form" class="space-y-6">
        <div>
          <label for="username" class="text-sm font-medium text-gray-700">Username</label>
          <input type="text" id="username" name="username" required class="w-full px-4 py-2 mt-2 text-gray-700 bg-gray-50 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
        </div>
        <div>
          <label for="password" class="text-sm font-medium text-gray-700">Password</label>
          <input type="password" id="password" name="password" required class="w-full px-4 py-2 mt-2 text-gray-700 bg-gray-50 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
        </div>
        <div id="login-error" class="text-sm text-center text-red-500 font-medium hidden"></div>
        <div class="flex items-center gap-4">
          <button type="button" id="close-login-modal" class="w-full px-4 py-2 font-semibold text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300">Batal</button>
          <button type="submit" id="login-button" class="w-full px-4 py-2 font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700">
            <span id="login-button-text">Login</span>
            <span id="login-spinner" class="hidden"><i class="fa fa-spinner fa-spin"></i></span>
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal Filter -->
  <div id="filter-modal" class="modal-overlay fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 hidden">
    <div class="w-full max-w-sm p-6 space-y-6 bg-white rounded-xl shadow-lg transform transition-all">
        <h2 class="text-xl font-bold text-gray-800">Filter SOP</h2>
        <div class="space-y-4">
            <div>
                <label for="filter-unit-modal" class="text-sm font-medium text-gray-700">Unit</label>
                <select id="filter-unit-modal" class="w-full p-2 mt-1 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    <option value="">Semua Unit</option>
                </select>
            </div>
            <div>
                <label for="filter-fungsi-modal" class="text-sm font-medium text-gray-700">Fungsi</label>
                <select id="filter-fungsi-modal" class="w-full p-2 mt-1 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    <option value="">Semua Fungsi</option>
                </select>
            </div>
        </div>
        <button id="close-filter-modal" class="w-full px-4 py-2 font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700">Terapkan & Tutup</button>
    </div>
  </div>

  <!-- Modal Konfirmasi Reload -->
  <div id="confirm-reload-modal" class="modal-overlay fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-50 hidden">
    <div class="w-full max-w-sm p-6 space-y-4 bg-white rounded-xl shadow-lg text-center transform transition-all">
        <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-blue-100">
            <i class="fas fa-sync-alt text-blue-600 text-xl"></i>
        </div>
        <h3 class="text-lg font-medium text-gray-900">Konfirmasi</h3>
        <p class="text-sm text-gray-500">Apakah Anda yakin ingin memuat ulang semua data SOP dari server?</p>
        <div class="flex items-center gap-4 pt-2">
            <button id="cancel-reload-button" class="w-full px-4 py-2 font-semibold text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300">Batal</button>
            <button id="confirm-reload-button" class="w-full px-4 py-2 font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700">Ya, Muat Ulang</button>
        </div>
    </div>
  </div>


  <div id="main-app">
    <header class="bg-white shadow-md sticky top-0 z-40">
      <div class="w-full px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <div class="flex items-center">
            <button id="hamburger-menu-button" class="p-2 rounded-md text-gray-600 hover:bg-gray-100">
              <i class="fas fa-bars"></i>
            </button>
            <a href="#" id="header-title-link" class="text-xl font-bold text-gray-800 ml-4">SOP IAIN Bone</a>
          </div>
          <div id="user-info-container" class="flex items-center gap-4">
            <!-- Tombol Login (Ikon) akan dimasukkan di sini oleh app.js -->
          </div>
        </div>
      </div>
    </header>

    <div id="popup-menu" class="fixed top-0 left-0 w-64 h-full bg-white shadow-lg z-50 transform -translate-x-full transition-transform duration-300">
        <div class="p-4">
            <h2 class="text-xl font-bold border-b pb-2">Menu</h2>
            <ul id="main-menu-list" class="mt-4 space-y-2">
                <li><a href="#" id="home-link" class="flex items-center py-2 px-4 hover:bg-gray-100 rounded"><i class="fas fa-home w-6 mr-2"></i>Beranda</a></li>
                <li><a href="#" id="about-link" class="flex items-center py-2 px-4 hover:bg-gray-100 rounded"><i class="fas fa-info-circle w-6 mr-2"></i>Tentang</a></li>
                <li class="border-t pt-2 mt-2"><a href="https://www.iain-bone.ac.id" target="_blank" class="flex items-center py-2 px-4 hover:bg-gray-100 rounded"><i class="fas fa-globe w-6 mr-2"></i>Web IAIN Bone</a></li>
                <li><a href="https://s.id/iainbone" target="_blank" class="flex items-center py-2 px-4 hover:bg-gray-100 rounded"><i class="fas fa-concierge-bell w-6 mr-2"></i>Informasi Layanan</a></li>
                <li><a href="https://ppid.iain-bone.ac.id" target="_blank" class="flex items-center py-2 px-4 hover:bg-gray-100 rounded"><i class="fas fa-bullhorn w-6 mr-2"></i>PPID</a></li>
            </ul>
        </div>
    </div>
    <div id="menu-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden"></div>

    <main class="w-full p-4 sm:p-6 lg:p-8">
      
      <div id="list-view-container">
        
        <section class="w-full">
            <!-- [DIUBAH] Baris kontrol tunggal yang responsif -->
            <div class="flex flex-wrap items-center justify-between gap-x-4 gap-y-3 mb-4">
                <h3 id="dataset-count" class="text-lg font-semibold text-gray-700 order-1"><i class="fa fa-spinner fa-spin"></i> Memuat data...</h3>

                <div class="flex items-center gap-2 flex-grow order-2 lg:order-3">
                    <!-- Search Mobile -->
                    <div class="relative flex-grow lg:hidden">
                        <input type="search" id="search-input-mobile" placeholder="Cari SOP..." class="w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"><i class="fa fa-search text-gray-400"></i></div>
                    </div>
                    <!-- Mobile Buttons -->
                    <div class="flex lg:hidden items-center gap-2">
                        <button id="open-filter-button" title="Buka Filter" class="bg-white border text-gray-700 font-bold p-2 w-12 h-10 rounded-lg hover:bg-gray-100 text-sm flex items-center justify-center">
                            <i class="fas fa-filter"></i>
                        </button>
                        <button id="reset-filter-button-mobile" title="Reset Filter" class="bg-white border text-gray-700 font-bold p-2 w-12 h-10 rounded-lg hover:bg-gray-100 text-sm flex items-center justify-center">
                            <i class="fas fa-undo"></i>
                        </button>
                    </div>
                </div>

                <div class="flex items-center gap-4 order-3 lg:order-2 lg:flex-grow lg:justify-end">
                    <!-- Search Desktop -->
                    <div class="relative hidden lg:block lg:flex-grow" style="max-width: 400px;">
                        <input type="search" id="search-input" placeholder="Cari Nama atau Nomor SOP..." class="w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"><i class="fa fa-search text-gray-400"></i></div>
                    </div>
                    <!-- Desktop Dropdowns -->
                    <div class="hidden lg:flex items-center gap-4">
                        <select id="filter-unit" class="p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 bg-white">
                            <option value="">Semua Unit</option>
                        </select>
                        <select id="filter-fungsi" class="p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 bg-white">
                            <option value="">Semua Fungsi</option>
                        </select>
                        <button id="reset-filter-button" class="bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-300 text-sm">Reset</button>
                    </div>
                </div>
                 <!-- Tombol Reload (selalu terlihat) -->
                <button id="reload-dataset-button" class="text-blue-600 hover:text-blue-800 font-bold p-2 rounded-lg text-lg flex items-center justify-center h-10 w-12 border bg-white order-4" title="Muat Ulang Data">
                    <i id="reload-icon" class="fas fa-sync-alt"></i>
                </button>
            </div>

            <div id="loading-indicator" class="text-center py-10"><i class="fa fa-spinner fa-spin fa-3x text-blue-500"></i><p class="mt-2 text-gray-600">Sedang memuat SOP...</p></div>
            
            <div class="bg-white rounded-lg shadow">
                <div class="overflow-x-auto hidden md:block">
                    <table class="w-full">
                        <thead class="bg-gray-50 border-b">
                            <tr>
                                <th class="p-4 text-left text-sm font-semibold text-gray-600">Nomor SOP</th>
                                <th class="p-4 text-left text-sm font-semibold text-gray-600">Nama SOP</th>
                                <th class="p-4 text-left text-sm font-semibold text-gray-600">Unit</th>
                                <th class="p-4 text-left text-sm font-semibold text-gray-600">Fungsi</th>
                            </tr>
                        </thead>
                        <tbody id="dataset-list" class="divide-y">
                        </tbody>
                    </table>
                </div>

                <div id="dataset-cards-container" class="md:hidden divide-y">
                </div>
            </div>

            <div id="pagination-container" class="flex justify-center items-center mt-8 space-x-2"></div>
            <div id="no-data-message" class="hidden text-center py-10 bg-white rounded-lg shadow-md"><i class="fa-solid fa-database fa-3x text-gray-400"></i><p class="mt-4 text-lg font-semibold text-gray-700">Data Tidak Ditemukan</p><p class="mt-1 text-gray-500">Coba ubah kata kunci pencarian atau filter Anda.</p></div>
        </section>
      </div>
      
      <div id="detail-view-container" class="hidden">
        <div class="flex items-center justify-between mb-6">
            <button id="back-to-list-button" class="text-blue-600 hover:text-blue-800 font-semibold flex items-center"><i class="fas fa-arrow-left mr-2"></i>Kembali ke Daftar</button>
            <span id="detail-status" class="text-sm font-bold px-3 py-1 rounded-full hidden"></span>
        </div>
        <!-- [PERBAIKAN] Tata letak grid baru yang responsif untuk halaman detail -->
        <div class="grid grid-cols-1 lg:grid-cols-10 gap-8">
            
            <!-- Kolom kiri di desktop, berisi Detail dan Metadata -->
            <div class="lg:col-span-3 flex flex-col gap-8">
                <!-- Bagian Detail: Selalu urutan ke-1 di mobile -->
                <section class="order-1 bg-white p-6 rounded-lg shadow-md space-y-4">
                    <h2 id="detail-title" class="text-xl font-bold text-gray-800"></h2>
                    <p id="detail-uraian" class="text-gray-600 text-sm"></p>
                    <div class="border rounded-lg p-4 flex items-center justify-between gap-4">
                        <i class="fas fa-file-pdf text-red-500 text-3xl"></i>
                        <a id="detail-download-link" href="#" target="_blank" class="text-blue-600 hover:text-blue-800 font-semibold">Unduh Dokumen</a>
                    </div>
                </section>

                <!-- Bagian Metadata: Urutan ke-3 di mobile -->
                <section class="order-3 bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3 border-b pb-2">Metadata</h3>
                    <table class="w-full text-sm text-left text-gray-600">
                        <tbody>
                            <tr class="border-b"><td class="py-2 font-semibold">Penandatangan</td><td id="meta-penandatangan" class="py-2 text-right"></td></tr>
                            <tr class="border-b"><td class="py-2 font-semibold">Unit</td><td id="meta-unit" class="py-2 text-right"></td></tr>
                            <tr class="border-b"><td class="py-2 font-semibold">Fungsi</td><td id="meta-fungsi" class="py-2 text-right"></td></tr>
                            <tr class="border-b"><td class="py-2 font-semibold">Tanggal Pembuatan</td><td id="meta-tanggal" class="py-2 text-right"></td></tr>
                            <tr id="meta-revisi-row" class="border-b hidden"><td class="py-2 font-semibold">Tanggal Revisi</td><td id="meta-diperbaharui" class="py-2 text-right"></td></tr>
                            <tr class="border-b"><td class="py-2 font-semibold">Tanggal Efektif</td><td id="meta-efektif" class="py-2 text-right"></td></tr>
                        </tbody>
                    </table>
                </section>
            </div>

            <!-- Kolom kanan di desktop, berisi Pratinjau PDF. Urutan ke-2 di mobile -->
            <div class="lg:col-span-7 order-2">
                <div id="table-preview-container" class="bg-white p-2 rounded-lg shadow-md h-full">
                    <div id="table-preview-content" class="w-full h-full">
                        <!-- Konten pratinjau (iframe) akan dimasukkan di sini -->
                    </div>
                </div>
            </div>
        </div>
      </div>

      <div id="about-view-container" class="hidden p-8 bg-white rounded-lg shadow-md">
        <h2 class="text-2xl font-bold text-gray-800 mb-4">Tentang E-SOP IAIN Bone</h2>
        <p class="text-gray-700 leading-relaxed">
            Sistem E-SOP IAIN Bone adalah sebuah platform terpusat yang dirancang untuk mengelola dan menyajikan Standar Operasional Prosedur (SOP) dari berbagai unit kerja di lingkungan Institut Agama Islam Negeri (IAIN) Bone. Tujuan utama dari sistem ini adalah untuk mewujudkan tata kelola dokumen yang akurat, mutakhir, terpadu, dan dapat diakses dengan mudah oleh seluruh pemangku kepentingan.
        </p>
      </div>
      
    </main>
  </div>

  <footer class="bg-white text-slate-600 text-sm text-center py-6 border-t">
    <p>&copy; 2025 - Dikelola oleh Biro AUAK IAIN Bone</p>
  </footer>
  
  <script src="app.js"></script>
</body>
</html>

